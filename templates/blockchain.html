{% extends './particular.html' %}


{% block content %}
    <link rel="stylesheet" href="../static/lib/bootstrap-table/bootstrap-table.min.css">
    <script src="../static/lib/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="../static/lib/bootstrap-table/bootstrap-table-zh-CN.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <style>
        /* 模态框居中样式 */
        .bootbox-container {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            z-index: 1049;
            overflow-y: auto;
        }

        .bootbox-container:empty {
            position: static;
        }

        .modal {
            display: table;
            width: 440px;
            height: 60%;
            margin: 0 auto;
        }

        .modal-dialog {
            display: table-cell;
            vertical-align: middle;
        }

        /* //模态框居中样式 */

        #numInputModal .modal-footer {
            border-top: none;
            margin-top: 15px;
        }

        #numInputModal .modal-footer .btn {
            width: 110px;
            margin-right: 58px;
        }

        #numInputModal .modal-header {
            border-bottom: none;
        }

        .price {
            height: 35px;
            line-height: 35px;
            font-size: 14px;
            color: #afafaf;
        }

        .price span {
            font-size: 20px;
            color: #53ff70;
            margin: 0 10px;
        }

        .electricity {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            font-size: 14px;
            color: #afafaf;

        }

        .electricity input {
            width: 56px;
            height: 27px;
            background-color: #1f2731;
            border-radius: 2px;
            text-indent: 10px;
            margin: 0 10px;
        }

        .electricity > div {
            height: 27px;
            background-color: #53afff;
            border-radius: 2px;
            padding: 0 13px;
            line-height: 27px;
            text-align: center;
            color: #ffffff;
            margin-left: 15px;
        }

        .electricity > div:last-child {
            background-color: #afafaf;
        }

        .outSide {
            width: 56px;
            height: 20px;
            background-color: #afafaf;
            line-height: 20px;
            text-align: center;
            font-size: 12px;
            position: relative;
            color: #000;
            border-radius: 2px;
            overflow: hidden;
        }

        .inSide {
            width: 20%;
            height: 20px;
            position: absolute;
            top: 0;
            left: 0;
            background: #53ff70;
            z-index:40;
        }
         .outSide span{
             position: relative;
             z-index: 50;
         }

        .infoTask {
            border-radius: 5px;
            padding: 17px 22px 0 22px;
        }

        .infoTask .infoContent {
            width: 100%;
            height: 300px;
            color: #afafaf;
            font-size: 12px;
            line-height: 30px;
        }

        .infoTask .infoContent p {
            margin: 0;
            display: flex;
            align-items: flex-start;
            flex-wrap: wrap;
        }

        .infoTask .infoContent p > span:first-child {
            margin-right: 20px;
            display: inline-block;
            width: 60px;


        }

        .infoTask .infoContent textarea {
            width: 820px;
            height: 90px;
            background-color: #1f2731;
        }

        .infoTask .infoContent .contType {
            display: inline-block;
            line-height: 27px;
            height: 27px;
            font-size: 12px;
            color: #fff;
            background: #53afff;
            padding: 0 4px;
            text-align: center;
            margin-left: 75px;
            box-sizing: content-box;
            margin-top: 20px;
            border-radius: 2px;
            cursor: pointer;
        }

        .tem-box .balance img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .tem-box .balance {
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;

        }

        .tem-box .balance span {
            display: inline-block;
            margin-right: 10px;
            flex-direction: row;
            white-space: nowrap;
        }

        .tem-box .goback {
            font-size: 12px;
            color: #afafaf;
            float: right;
            margin-right: 20px;
            position: absolute;
            top: 20px;
            cursor: pointer;
            right: 20px;
        }

        .green {
            color: #5eff53;
        }

        .blue {
            color: #53afff;

        }

        .infoTask .money {
            height: 290px;
            width: 100%;
            display: flex;
            justify-content: flex-start;
            padding: 20px 0;
            box-sizing: border-box;
            position: relative;

        }

        .infoTask .money > div {
            width: 414px;
            height: 250px;
            background-color: #1f2731;
            border-radius: 5px;
            margin-right: 20px;
            padding: 15px;
            box-sizing: border-box;
        }

        .infoTask .money > div .residue {
            color: #53ff70;
            font-size: 30px;
            font-weight: bold;
        }

        .infoTask .money > div .OR {
            color: #ffb453;
        }

        .infoTask .money .infoContent {
            height: auto;
            position: absolute;
            bottom: 40px;
            left: 20px;
        }

        .infoTask .money .infoContent p > span:first-child {
            width: 90px;
        }
        .maskFill{
            width: 100%;
            height: 500px;
            background: #000;
        }
        #myTabContent{
          height: 500px;
            overflow: hidden;
        }


        {# ``````````````````#}

    </style>

    <!--统计查询-->
    <div id="app">


        <ul v-show="type==0" id="myTab" class="nav nav-tabs">
            <li class="active"><a href="#node_1" data-toggle="tab">任务</a></li>
            <li><a href="#node_2" data-toggle="tab">区块</a></li>
            <li><a href="#node_3" data-toggle="tab">账户</a></li>
            <li><a href="#node_4" data-toggle="tab">矿机</a></li>
        </ul>

        <div v-show="type==0" id="myTabContent" class="tab-content">
        <div class="maskFill"></div>





            <!--任务-->
            <div ref="task" class="tab-pane fade  in active" id="node_1">
                <table class="table" id="node_table_1"></table>
            </div>

            <!--区块-->
            <div ref="block" class="tab-pane fade " id="node_2">
                <table class="table" id="node_table_2"></table>
            </div>

            <div ref="user" class="tab-pane fade " id="node_3">
                <table class="table" id="node_table_3"></table>
            </div>

            <div class="tab-pane fade " id="node_4">
                <div class="price">NTA价格<span>991.85</span>元/NTA</div>
                <div class="electricity">
                    <sapn>电价</sapn>
                    <input placeholder="0.3" type="number">
                    <sapn>元/度</sapn>
                    <div>计算</div>
                    <div>免费电</div>
                </div>
                <table class="table" id="node_table_4"></table>
            </div>
        </div>
        {% verbatim %}

            <div id="info" class="infoTask" v-show="type==1">
                <div class="tem-box">
                    <div class="store">任务信息
                    </div>
                    <span @click="goback" class="goback">返回上一级</span>
                </div>
                <div class="infoContent">
                    <p>
                        <span>任务标识</span>
                        {{ contList.indentify }}
                    </p>
                    <p>
                        <span>任务状态</span>
                        <span class="green">成功</span>
                    </p>
                    <p>
                        <span>区块高度</span>
                        <a href="#" class="blue" @click="goHeight">{{ contList.block_depth }}</a>
                    </p>
                    <p>
                        <span>任务时间</span>
                        {{ contList.task_time }}
                    </p>
                    <p>
                        <span>发送方</span>
                        <a href="#" class="blue" @click="goAccount">{{ contList.poster }}</a>

                    </p>
                    <p>
                        <span>接收方</span>
                        <a href="#" class="blue" @click="goAccount">{{ contList.receiver }}</a>

                    </p>
                    <p>
                        <span>代币交易</span>
                        {{ contList.transaction1 }} &nbsp; <span class="blue">DCCB</span> &nbsp; 从 &nbsp; <a href="#"
                                                                                                             class="blue"
                                                                                                             @click="goAccount">{{ contList.poster }}</a>
                        &nbsp; 转移至 &nbsp; <a href="#" class="blue" @click="goAccount">{{ contList.receiver }}</a>
                    </p>
                    <p>
                        <span>任务量</span>
                        {{ contList.task_num }}
                    </p>
                    <p>
                        <span>任务费用</span>
                        {{ contList.task_price }}
                    </p>
                    <p>
                        <span> 操作数</span>
                        {{ contList.op_num }}
                    </p>
                    <p>
                        <span> 输入数据</span>
                        <textarea></textarea>
                    </p>
                    <span @click="analysis" class="contType" v-show="!contType">解析数据</span>
                    <span @click="analysis" class="contType" v-show="contType">显示原始数据</span>
                </div>

            </div>
            <div class="infoTask" v-show="type==2">
                <div class="tem-box">
                    <div class="store">区块信息
                    </div>
                    <span @click="goback" class="goback">返回上一级</span>

                </div>
                <div class="infoContent">
                    <p>
                        <span>区块高度</span>
                        <span class="blue"> <span @click="backUp" class="glyphicon glyphicon-chevron-left"
                                                  aria-hidden="true"></span>&nbsp; {{ blockInfoList.block_depth }} &nbsp;<span
                                @click="backNext" class="glyphicon glyphicon-chevron-right"
                                aria-hidden="true"></span></span>
                    </p>
                    <p>
                        <span>出块时间</span>
                        {{ blockInfoList.block_out_time }}
                    </p>
                    <p>
                        <span>处理内容</span>
                        <span class="blue">{{ blockInfoList.content_task_num }}笔任务</span>
                    </p>
                    <p>
                        <span>哈希值</span>
                        {{ blockInfoList.hash }}
                    </p>
                    <p>
                        <span>父块哈希值</span>
                        {{ blockInfoList.f_hash }}

                    </p>
                    <p>
                        <span>矿工</span>
                        <!--                  <a href="#" class="blue" @click="goAccount">{{ blockInfoList.miner }}</a>-->
                        {{ blockInfoList.miner }}
                    </p>
                    <p>
                        <span>大小</span>
                        {{ blockInfoList.size }}MB
                    </p>
                    <p>
                        <span>操作数</span>
                        {{ blockInfoList.op_num }}
                    </p>
                    <p>
                        <span>区块奖励</span>
                        {{ blockInfoList.reward }}
                    </p>
                    <p>
                        <span> 附加数据</span>
                        {{ blockInfoList.additional_data }}
                    </p>
                </div>
            </div>
            <div class="infoTask" v-show="type==3">
                <div class="tem-box">
                    <div class="store balance">
                        <img src="../static/images/balance.png" alt="">
                        <span>{{ accountInfoList.address }}</span>
                        <span>账户信息</span>
                    </div>
                    <span @click="goback" class="goback">返回上一级</span>

                </div>
                <div class="money ">
                    <div>
                        <p>NTA余额</p>
                        <p class="residue">{{ accountInfoList.balance }} NTA</p>
                        <div class="infoContent">
                            <p>
                                <span>NTA美元价值</span>
                                <span class="blue"> $381,720,547.26 ($142.56/NTA)</span>
                            </p>
                            <p>
                                <span>NTA人民币价值</span>
                                <span class="blue">￥2,423,936,185.54 (￥905.26/NTA)</span>
                            </p>
                            <p>
                                <span>转账笔数</span>
                                <span class="blue">{{ accountInfoList.num }}笔</span>
                            </p>


                        </div>
                    </div>
                    <div><p>NTA余额</p>
                        <p class="residue OR ">{{ accountInfoList.balance }} NTA</p>
                    </div>

                </div>
                <div>
                    <table ref="account_1" class="table" id="account_1"></table>
                </div>

            </div>
        {% endverbatim %}
    </div>





    {#//电费占比#}
    {#<div class="outSide">#}
    {#<div style=" width: 30%;" class="inSide"></div>#}
    {#<span>30%</span>#}
    {#</div>#}
    <script>
        // 我的节点
        $(function () {
            $(".blockchain").siblings().css("display", "none");
            $(".blockchain").css("display", "block");
            $('#blockchain img:eq(0)').css("display", "none");
            $('#blockchain img:eq(1)').css("display", "block");
            $('#blockchain div').css("color", "#427CFF");
            $('#blockchain').siblings().children("img").hide();
            $('#blockchain').siblings().children(".now").show();
            $('#blockchain').siblings().children().css("color", "#fafafa");
            $()
        });
    </script>

    <script>

        var token = "Bearer " + localStorage.token;
        //节点数量管理表初始化
        var TableInit = function () {
            var oTableInit = {};
            //初始化Table
            oTableInit.Init = function () {
                $('#node_table_1').bootstrapTable({
                    url: '/blocktask',         //请求后台的URL（*）
                    method: 'get',                      //请求方式（*）
                    toolbar: '#toolbar_1',                //工具按钮用哪个容器
                    striped: true,                      //是否显示行间隔色
                    cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    pagination: true,                   //是否显示分页（*）
                    sortable: false,                     //是否启用排序
                    sortOrder: "asc",                   //排序方式
                    queryParams: oTableInit.queryParams,//传递参数（*）
                    sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                       //初始化加载第一页，默认第一页
                    pageSize: 10,                       //每页的记录行数（*）
                    pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
                    {#search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大#}
                    {#strictSearch: false,                //启用严格搜索#}
                    {#showColumns: true,                  //是否显示所有的列#}
                    {#showRefresh: true,                  //是否显示刷新按钮#}
                    minimumCountColumns: 2,             //最少允许的列数
                    clickToSelect: false,                //是否启用点击选中行
                    height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                    uniqueId: "node_type",                     //每一行的唯一标识，一般为主键列
                    showToggle: false,                    //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    showFooter:false,
                    columns: [{
                        field: 'indentify',
                        title: '任务标识',
                        formatter: returnindentify,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'block_depth',
                        title: '区块高度',
                        formatter: returnblockheight,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_time',
                        title: '任务时间',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'poster',
                        title: '发送方',
                        formatter: returnuser,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'receiver',
                        title: '接收方',
                        formatter: returnuser,
                        align: "center",
                        valign: "middle"
                    }, {
                          field: 'transaction',
                        title: '交易额',
                        align: "center",
                        valign: "middle"
                    },{
                        field: 'task_num',
                        title: '任务量',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_price',
                        title: '任务费',
                        align: "center",
                        valign: "middle"
                    }]
                });
            };

            //得到查询的参数
            oTableInit.queryParams = function (params) {
                var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                    limit: params.limit,   //页面大小
                    offset: params.offset,  //页码
                };
                return temp;
            };
            return oTableInit;
        };

        //生成任务标识列链接
        function returnindentify(value, row, index) {
            return '<a href="#" class="blue task" ref="task1">' + value + '</a>'
        }

        //生成区块高度链接
        function returnblockheight(value, row, index) {
            return '<a href="#" class="blue block" @click="goHeight(\'' + value + '\')">' + value + '</a>'
        }

        function returnuser(value, row, index) {
            return '<a href="#" class="blue user" @click="goAccount(\'' + value + '\')">' + value + '</a>'
        }


        //节点运行管理表初始化
        var TableInit_2 = function () {
            var oTableInit = {};
            //初始化Table
            oTableInit.Init = function () {
                $('#node_table_2').bootstrapTable({
                    url: '/block',         //请求后台的URL（*）
                    method: 'get',                      //请求方式（*）
                    toolbar: '#toolbar_2',                //工具按钮用哪个容器
                    striped: true,                      //是否显示行间隔色
                    cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    pagination: true,                   //是否显示分页（*）
                    sortable: false,                     //是否启用排序
                    sortOrder: "asc",                   //排序方式
                    queryParams: oTableInit.queryParams,//传递参数（*）
                    sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                       //初始化加载第一页，默认第一页
                    pageSize: 10,                       //每页的记录行数（*）
                    pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
                    {#search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大#}
                    {#strictSearch: false,                //启用严格搜索#}
                    {#showColumns: true,                  //是否显示所有的列#}
                    {#showRefresh: true,                  //是否显示刷新按钮#}
                    minimumCountColumns: 2,             //最少允许的列数
                    clickToSelect: true,                //是否启用点击选中行
                    height: 420,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                    uniqueId: "node_type",                     //每一行的唯一标识，一般为主键列
                    showToggle: false,                    //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    showFooter:false,
                    columns: [{
                        field: 'block_depth',
                        title: '区块高度',
                        formatter: returnblockheight,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'block_out_time',
                        title: '出块时间',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_num',
                        title: '任务量',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'miner',
                        title: '矿工',
                        formatter: returnuser,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'upper_limit',
                        title: '燃料上限',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'barrier',
                        title: '挖矿难度',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'calculation',
                        title: '算力',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'reward',
                        title: '奖励',
                        align: "center",
                        valign: "middle"
                    }]
                });
            };

            //得到查询的参数
            oTableInit.queryParams = function (params) {
                var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                    limit: params.limit,   //页面大小
                    offset: params.offset,  //页码
                    uid: localStorage.user_id,
                };
                return temp;
            };
            return oTableInit;
        };

        //节点运行管理表初始化
        var TableInit_3 = function () {
            var oTableInit = {};
            //初始化Table
            oTableInit.Init = function () {
                $('#node_table_3').bootstrapTable({
                    url: '/blockacount',         //请求后台的URL（*）
                    method: 'get',                      //请求方式（*）
                    toolbar: '#toolbar_3',                //工具按钮用哪个容器
                    striped: true,                      //是否显示行间隔色
                    cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    pagination: true,                   //是否显示分页（*）
                    sortable: false,                     //是否启用排序
                    sortOrder: "asc",                   //排序方式
                    queryParams: oTableInit.queryParams,//传递参数（*）
                    sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                       //初始化加载第一页，默认第一页
                    pageSize: 10,                       //每页的记录行数（*）
                    pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
                    {#search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大#}
                    {#strictSearch: false,                //启用严格搜索#}
                    {#showColumns: true,                  //是否显示所有的列#}
                    {#showRefresh: true,                  //是否显示刷新按钮#}
                    minimumCountColumns: 2,             //最少允许的列数
                    clickToSelect: true,                //是否启用点击选中行
                    height: 420,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                    uniqueId: "node_type",                     //每一行的唯一标识，一般为主键列
                    showToggle: false,                    //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    showFooter:false,
                    columns: [{
                        field: 'oeder',
                        title: '排名',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'address',
                        title: '地址',
                        formatter: returnuser,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'balance',
                        title: '余额',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'percent',
                        title: '占比',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_num',
                        title: '任务数量',
                        align: "center",
                        valign: "middle"
                    }]
                });
            };

            //得到查询的参数
            oTableInit.queryParams = function (params) {
                var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                    limit: params.limit,   //页面大小
                    offset: params.offset,  //页码
                    uid: localStorage.user_id,
                };
                return temp;
            };
            return oTableInit;
        };

        //节点运行管理表初始化
        var TableInit_4 = function () {
            var oTableInit = {};
            //初始化Table
            oTableInit.Init = function () {
                $('#node_table_4').bootstrapTable({
                    url: '/miner',         //请求后台的URL（*）
                    method: 'get',                      //请求方式（*）
                    toolbar: '#toolbar_4',                //工具按钮用哪个容器
                    striped: true,                      //是否显示行间隔色
                    cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    pagination: true,                   //是否显示分页（*）
                    sortable: false,                     //是否启用排序
                    sortOrder: "asc",                   //排序方式
                    queryParams: oTableInit.queryParams,//传递参数（*）
                    sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                       //初始化加载第一页，默认第一页
                    pageSize: 10,                       //每页的记录行数（*）
                    pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
                    {#search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大#}
                    {#strictSearch: false,                //启用严格搜索#}
                    {#showColumns: true,                  //是否显示所有的列#}
                    {#showRefresh: true,                  //是否显示刷新按钮#}
                    minimumCountColumns: 2,             //最少允许的列数
                    clickToSelect: true,                //是否启用点击选中行
                    height: 350,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                    uniqueId: "node_type",                     //每一行的唯一标识，一般为主键列
                    showToggle: false,                    //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    showFooter:false,
                    columns: [{
                        field: 'machine',
                        title: 'NTA节点',
                        align: "center",
                        valign: "middle"
                    },{
                        field: 'node_type',
                        title: '节点类型',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'price',
                        title: '节点单价',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'calculation',
                        title: '算力',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'power',
                        title: '功率',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'persent',
                        title: '能效比',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'day_out',
                        title: '日产出',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'day_ele',
                        title: '日电费',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'e_per',
                        title: '电费占比',
                        formatter: elefee,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'obtain',
                        title: '日净收益',
                        align: "center",
                        valign: "middle"
                    }]
                });
            };

            //得到查询的参数
            oTableInit.queryParams = function (params) {
                var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                    limit: params.limit,   //页面大小
                    offset: params.offset,  //页码
                    uid: localStorage.user_id,
                };
                return temp;
            };
            return oTableInit;
        };

        function elefee(value, row, index) {
            return '<div class="outSide">\n' +
                '<div style=" width: '+value+';" class="inSide"></div>\n' +
                '<span>'+value+'</span>\n' +
                '</div>'
        }


        var oTable = new TableInit();

        var oTable2 = new TableInit_2();


        var oTable3 = new TableInit_3();

        var oTable4 = new TableInit_4();


        function update_table1() {


            $.ajax({
                    url: "/updateblocktask/",
                    contentType: "application/json",
                    headers: {
                        Authorization: token,
                    },
                    data: {},
                    Type: 'GET',
                    async: false,
                    cache: false,
                    success: function (data) {
                        table1 = $('#node_table_1');
                        console.log('data:11111111111111', data);
                        rows_num = table1.bootstrapTable('getOptions').totalRows;
                        if (rows_num >= 50){
                            allTableData = table1.bootstrapTable('getData');
                            if(data.length===0){
                                return
                            }
                            allTableData = allTableData.slice(-data.length);
                            cuttable = [];
                            for(j = 0; j < allTableData.length; j++) {
                                cuttable.push(allTableData[j].indentify);
                            }
                            table1.bootstrapTable('remove',{
                                    field: "indentify",   //此处的 “id”对应的是字段名
                                    values: cuttable
                                });
                            $('#node_table_1').bootstrapTable('prepend', data);

                        }
                        else {
                            $('#node_table_1').bootstrapTable('prepend', data);
                        }
                    },
                    fail: function (er) {
                        console.log(er)

                    }
            });


            data = [{
                "indentify": "Oxa65465f654sgdg4654",
                "block_depth": 5000,
                "task_time": "2020-01-01 15:39:02",
                "poster": "OxaOfcf587sdsf55",
                "receiver": "OxaOfcf587sdsf56",
                "task_num": "0.1NTA",
                "task_price": "0.1NTA"
            }];


        }


        function update_table2() {


            $.ajax({
                    url: "/updateblock/",
                    contentType: "application/json",
                    headers: {
                        Authorization: token,
                    },
                    data: {},
                    Type: 'GET',
                    async: false,
                    cache: false,
                    success: function (data) {
                        table2 = $('#node_table_2');
                        console.log('data:11111111111111', data);
                        rows_num = table2.bootstrapTable('getOptions').totalRows;
                        if (rows_num >= 50){
                            allTableData = table2.bootstrapTable('getData');
                            if(data.length===0){
                                return
                            }
                            allTableData = allTableData.slice(-data.length);
                            cuttable = [];
                            for(j = 0; j < allTableData.length; j++) {
                                cuttable.push(allTableData[j].indentify);
                            }
                            table2.bootstrapTable('remove',{
                                    field: "indentify",   //此处的 “id”对应的是字段名
                                    values: cuttable
                                });
                            {#$('#node_table_2').bootstrapTable('prepend', data);#}
                        }
                        else {
                            {#$('#node_table_2').bootstrapTable('prepend', data)#}
                            console.log(data);
                        }
                    },
                    fail: function (er) {
                        console.log(er)

                    }
            });


            data = [{
                "indentify": "Oxa65465f654sgdg4654",
                "block_depth": 5000,
                "task_time": "2020-01-01 15:39:02",
                "poster": "OxaOfcf587sdsf55",
                "receiver": "OxaOfcf587sdsf56",
                "task_num": "0.1NTA",
                "task_price": "0.1NTA"
            }];


        }


        function update_table3(){
            console.log('update333333333');
            $('#node_table_3').bootstrapTable('refresh');
        }

        $(function () {


            //1.初始化Table1 其他的在

            oTable.Init();

            //2.初始化Button的点击事件
//            var oButtonInit = new ButtonInit();
//            oButtonInit.Init();

            // 初始化Table2


            name2table = {
                '#node_1': oTable,
                '#node_2': oTable2,
                '#node_3': oTable3,
                '#node_4': oTable4
            };

            $('a[data-toggle="tab"]').on('show.bs.tab', function (e) {
                href_ = e.target.attributes.href.value;
                a = name2table[href_];



                a.Init();
                console.log(11111111111, e.target.attributes.href); // 激活的标签页

            });


            setInterval("update_table1()",3000);
            setInterval("update_table2()",3000);
            setInterval("update_table3()",3000);


        });
        var TableInit_5 = function (account_hash) {
            var oTableInit = {};
            //初始化Table
            oTableInit.Init = function () {
                $("#account_1").bootstrapTable('destroy');
                $('#account_1').bootstrapTable({

                    url: '/blocktask?account_hash='+account_hash,         //请求后台的URL（*）
                    method: 'get',                      //请求方式（*）
                    toolbar: '#account1',                //工具按钮用哪个容器
                    striped: true,                      //是否显示行间隔色
                    cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
                    pagination: true,                   //是否显示分页（*）
                    sortable: false,                     //是否启用排序
                    sortOrder: "asc",                   //排序方式
                    queryParams: oTableInit.queryParams,//传递参数（*）
                    sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
                    pageNumber: 1,                       //初始化加载第一页，默认第一页
                    pageSize: 10,                       //每页的记录行数（*）
                    pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
                    {#search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大#}
                    {#strictSearch: false,                //启用严格搜索#}
                    {#showColumns: true,                  //是否显示所有的列#}
                    {#showRefresh: true,                  //是否显示刷新按钮#}
                    minimumCountColumns: 2,             //最少允许的列数
                    clickToSelect: false,                //是否启用点击选中行
                    height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
                    uniqueId: "node_type",                     //每一行的唯一标识，一般为主键列
                    showToggle: false,                    //是否显示详细视图和列表视图的切换按钮
                    cardView: false,                    //是否显示详细视图
                    detailView: false,                   //是否显示父子表
                    columns: [{
                        field: 'indentify',
                        title: '任务标识',
                        formatter: returnindentify,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'block_depth',
                        title: '区块高度',
                        formatter: returnblockheight,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_time',
                        title: '任务时间',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'poster',
                        title: '发送方',
                        formatter: returnuser,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'receiver',
                        title: '接收方',
                        formatter: returnuser,
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_num',
                        title: '任务量',
                        align: "center",
                        valign: "middle"
                    }, {
                        field: 'task_price',
                        title: '任务费',
                        align: "center",
                        valign: "middle"
                    }]
                });
            };

            //得到查询的参数
            oTableInit.queryParams = function (params) {
                var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                    limit: params.limit,   //页面大小
                    offset: params.offset,  //页码
                    account_hash:account_hash,
                };
                return temp;
            };
            return oTableInit;
        };

        //生成任务标识列链接
        function returnindentify(value, row, index) {
            return '<a href="#" class="blue task" ref="task1">' + value + '</a>'
        }

        //生成区块高度链接
        function returnblockheight(value, row, index) {
            return '<a href="#" class="blue block" @click="goHeight(\'' + value + '\')">' + value + '</a>'
        }

        function returnuser(value, row, index) {
            return '<a href="#" class="blue user" @click="goAccount(\'' + value + '\')">' + value + '</a>'
        }

    </script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script>

        var app = new Vue({
            el: '#app',
            data: {
                type: 0,//0 默认表格 1任务信息 2区块高度/信息 3账户信息
                contType: false,
                contList: {}, // 存放任务信息
                blockInfoList: {}, // 存放区块信息
                accountInfoList: {}, // 存放用户信息
                routerList:[0],
            },
            mounted() {
                let that = this;
                console.log(that.$refs.task, 'dedededededede');
                //应该这么绑定 才可以 触发

                $(that.$refs.task).on("click", "a.task", that.taskTip);
                $(that.$refs.task).on("click", "a.block", that.goHeight);
                $(that.$refs.task).on("click", "a.user", that.goAccount);

                $(that.$refs.block).on("click", "a.block", that.goHeight);
                $(that.$refs.block).on("click", "a.user", that.goAccount);

                $(that.$refs.user).on("click", "a.user", that.goAccount);

                $(that.$refs.account_1).on("click", "a.task", that.taskTip);
                $(that.$refs.account_1).on("click", "a.block", that.goHeight);
                $(that.$refs.account_1).on("click", "a.user", that.goAccount);
                $('.maskFill').hide()

            },
            {# updated (){#}
            {#let that=this#}
            {#     if (that.type==0) {#}
            {#           that.back=0#}
            {#       }#}
            {# },#}
            methods: {

                {#返回你#}
                goback() {
                    let that = this;
                    that.type=that.routerList[that.routerList.length-2]
                   that.routerList.pop();
                    console.log(that.routerList,that.type);
                },
                {#    解析数据#}
                analysis() {
                    let that = this;
                    that.contType = !that.contType

                },
                {#任务标识点击#}
                taskTip(event) {

                    let vm = this;
                    console.log('taskTip',event.currentTarget.text);
                    indentify = event.currentTarget.text;
                    $.ajax({
                        url: "/blocktaskdetail/",
                        contentType: "application/json",
                        headers: {
                            Authorization: token,
                        },
                        data: {indentify: indentify},
                        Type: 'GET',
                        async: false,
                        cache: false,
                        success: function (data) {
                            console.log('data:', data);
                            vm.contList = data
                        },
                        fail: function (er) {
                            console.log(er)

                        }
                    });

                    let that = this;
                    that.type = 1;
                    that.routerList.push(that.type)
                },
                {#    任务高度#}
                goHeight(event, height) {
                    let that = this;
                    if (height) {
                        blockheight = height
                    }
                    else {
                        that.type = 2;
                        that.routerList.push(that.type);
                        blockheight = event.currentTarget.text;
                    }

                    $.ajax({
                        url: "/blockdetail/",
                        contentType: "application/json",
                        headers: {
                            Authorization: token,
                        },
                        data: {blockheight: blockheight},
                        Type: 'GET',
                        async: false,
                        cache: false,
                        success: function (data) {
                            console.log('data2:', data);
                            that.blockInfoList = data
                        },
                        fail: function (er) {
                            console.log(er)

                        }
                    });
                },
                {#    账户信息#}
                goAccount(event) {

                    let that = this;
                    console.log(event);
                    let acount_hash = event.currentTarget.text;

                    $.ajax({
                        url: "/blockacountdetail/",
                        contentType: "application/json",
                        headers: {
                            Authorization: token,
                        },
                        data: {acount_hash: acount_hash},
                        Type: 'GET',
                        async: false,
                        cache: false,
                        success: function (data) {
                            console.log('account data:', data);
                            that.accountInfoList = data
                        },
                        fail: function (er) {
                            console.log(er)

                        }
                    });





                    var oTable5 = new TableInit_5(acount_hash);
                    oTable5.Init();



                    that.type = 3;
                    that.routerList.push(that.type)

                },
                {#    下一个高度#}
                backNext() {

                    this.goHeight('', this.blockInfoList.block_depth + 1)

                },
                {#    上一个高度#}
                backUp() {
                    this.goHeight('', this.blockInfoList.block_depth - 1)
                }
            }
        });

    </script>
    <script>


    </script>
{% endblock %}